{% load static %}
{% load humanize %}
{% load apptags_extras %}

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">

  <link rel="stylesheet" href="extensions/sticky-header/bootstrap-table-sticky-header.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="shortcut icon" href="{% static 'img/icon2.ico' %}" />
  <link rel="stylesheet" href="{% static 'css/inicio.css' %}">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/material-design-iconic-font/2.2.0/css/material-design-iconic-font.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/1.10.23/css/dataTables.bootstrap4.min.css">

  <link href="{% static 'adminpro/assets/plugins/bootstrap-select/bootstrap-select.min.css' %}" rel="stylesheet" />
  <link href="{% static 'adminpro/assets/plugins/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">
  <link href="{% static 'adminpro/assets/plugins/perfect-scrollbar/css/perfect-scrollbar.css' %}" rel="stylesheet">
  <link href="{% static 'adminpro/assets/plugins/chartist-js/dist/chartist.min.css' %}" rel="stylesheet">
  <link href="{% static 'adminpro/assets/plugins/chartist-plugin-tooltip-master/dist/chartist-plugin-tooltip.css' %}"
    rel="stylesheet">
  <link href="{% static 'adminpro/assets/plugins/c3-master/c3.min.css' %}" rel="stylesheet">
  <link href="{% static 'adminpro/assets/plugins/toast-master/css/jquery.toast.css' %}" rel="stylesheet">
  <link href="{% static 'adminpro/main/css/style.css' %}" rel="stylesheet">
  <link href="{% static 'adminpro/main/css/pages/dashboard1.css' %}" rel="stylesheet">
  <!-- Aqui cambiamos el tema -->
  <link href="{% static 'adminpro/main/css/colors/purple-dark.css' %}" id="theme" rel="stylesheet">
  <link href="{% static 'adminpro/main/css/pages/chat-app-page.css' %}" rel="stylesheet">
  <link href="{% static 'adminpro/main/css/pages/file-upload.css' %}" rel="stylesheet">
  <link href="{% static 'adminpro/assets/plugins/multiselect/css/multi-select.css' %}" rel="stylesheet"
    type="text/css" />
  <link href="{% static 'adminpro/assets/plugins/bootstrap-tagsinput/dist/bootstrap-tagsinput.css' %}"
    rel="stylesheet" />
  <link href="{% static 'adminpro/assets/plugins/bootstrap-touchspin/dist/jquery.bootstrap-touchspin.min.css' %}"
    rel="stylesheet" />
  <link href="{% static 'adminpro/assets/plugins/multiselect/css/multi-select.css' %}" rel="stylesheet"
    type="text/css" />
  <link href="{% static 'adminpro/assets/plugins/bootstrap-datepicker/bootstrap-datepicker.min.css' %}" rel="stylesheet"
    type="text/css" />
  <link href="{% static 'adminpro/assets/plugins/select2/dist/css/select2.min.css' %}" rel="stylesheet"
    type="text/css" />
  <link href="{% static 'adminpro/assets/plugins/switchery/dist/switchery.min.css' %}" rel="stylesheet" />
  <link href="{% static 'adminpro/assets/plugins/bootstrap-select/bootstrap-select.min.css' %}" rel="stylesheet" />
  <title>Mapafer</title>

</head>

<body class="fix-header fix-sidebar card-no-border">
  <!-- ============================================================== -->
  <!-- Preloader - style you can find in spinners.css -->
  <!-- ============================================================== -->
  <div class="preloader">
    <div class="loader">
      <div class="loader__figure" ></div>
      <p class="loader__label">Mapafer</p>
    </div>
  </div>
  <!-- ============================================================== -->
  <!-- Main wrapper - style you can find in pages.scss -->
  <!-- ============================================================== -->
  <div id="main-wrapper">
    <header class="topbar">
      <nav class="navbar top-navbar navbar-expand-md navbar-light">
        <div class="navbar-header" id="navbar">
          <a class="navbar-brand" href="{% url 'Home' %}">

            <b>
              <img src="{% static 'img/brote1.png' %}" style="max-width: 50px; vertical-align: bottom; margin: 5px;" 
              alt="" class="dark-logo" id="dark-logo" />
              <img src="{% static 'img/brote1.png' %}" style="max-width: 50px; vertical-align: bottom; margin: 10px;" 
              alt="" class="light-logo" id="light-logo" />
            </b>
            <span>
              
              <img src="{% static 'img/Mapafer.png' %}" style="max-width: 60px; vertical-align: bottom; margin-bottom: 12px;" alt="" class="dark-logo" />
              
              <img src="{% static 'img/Mapafer.png' %}" class="mb-3" style="max-width: 120px; vertical-align: bottom;" class="light-logo"
                alt="" />
            </span>
          </a>

        </div>
        <!-- ============================================================== -->
        <!-- End Logo -->
        <!-- ============================================================== -->
        <div class="navbar-collapse">
          <!-- ============================================================== -->
          <!-- toggle and nav items -->
          <!-- ============================================================== -->
          <ul class="navbar-nav mr-auto">
            <!-- This is  -->
            <li class="nav-item"> <a class="nav-link nav-toggler hidden-md-up waves-effect waves-dark"
                href="javascript:void(0)"><i class="ti-menu"></i></a> </li>
            <li class="nav-item"> <a class="nav-link sidebartoggler hidden-sm-down waves-effect waves-dark"
                href="javascript:void(0)"><i class="ti-menu"></i></a> </li>

          </ul>
          <ul class="navbar-nav my-lg-0">
            <li>
              {% if request.user|has_rol:"ADM" %}
              <a class="nav-link waves-effect waves-dark" href="{% url 'Gestion de usuarios' %}" ><i data-toggle="tooltip" data-placement="left" title="Gestión de usuarios" class="fa fa-users text-light"></i></a>
              {% endif %}
              <a class="nav-link waves-effect waves-dark" href="{% url 'Logout' %}" ><i class="fa fa-power-off text-light"></i></a>
              
            </li>
          </ul>

        </div>

        
      </nav>
    </header>

    <aside class="left-sidebar">
      <div class="scroll-sidebar">
        <nav class="sidebar-nav">
          <ul id="sidebarnav">
            <li class="nav-small-cap">MENÚ</li>
            <li class="nav-devider"></li>
            {% if request.user|has_rol:"EMPRESA" %}
            <li class="nav-small-cap">TU ESPACIO</li>

            <li> <a href="#"><i class="fa fa-angle-right"></i><span class="hide-menu"> Empleados activos</span></a></li>

            <li> <a href="#"><i class="fa fa-angle-right"></i><span class="hide-menu"> Pagos realizados</span></a></li>

            {% elif request.user|has_rol:"USER" %}
            <li class="nav-small-cap">TU ESPACIO</li>

            <li> <a href="{% url 'Prestamo usuarios' %}"><i class="fa fa-angle-right"></i><span class="hide-menu"> Proximas cuotas</span></a></li>

            <li> <a href="{% url 'Panel de pagos para usuarios' %}"><i class="fa fa-angle-right"></i><span class="hide-menu"> Pagos realizados</span></a></li>
            {% else %}
            <li class="nav-small-cap">BASE DE DATOS</li>

            <li> <a href="{% url 'BBDD clientes' %}"><i class="fa fa-angle-right"></i><span class="hide-menu"> Clientes</span></a></li>

            <li> <a href="{% url 'Panel proveedor' %}"><i class="fa fa-angle-right"></i><span class="hide-menu"> Proveedores</span></a></li>

            <li> <a href="{% url 'Panel de empresas' %}"><i class="fa fa-angle-right"></i><span class="hide-menu"> Empresas</span></a></li>

            <li> <a href="{% url 'Principal Prestamos' %}"><i class="fa fa-angle-right"></i><span class="hide-menu"> Creditos</span></a></li>

            <li class="nav-small-cap">INFORMES</li>
            <li> <a href="{% url 'Principal caja' %}"><i class="fa fa-inbox"></i><span class="hide-menu"> Caja</span></a></li>
            <li> <a href="{% url 'Panel de pagos' %}"><i class="fa fa-inbox"></i><span class="hide-menu"> Cobranza</span></a></li>
            <li> <a href="{% url 'Cash Flow' %}"><i class="fa fa-area-chart"></i><span class="hide-menu"> Flujos</span></a></li>

            <li class="nav-small-cap">INFORMACIÓN</li>

            <li> <a href="{% url 'Aclaraciones' %}"><i class="fa fa-info"></i><span class="hide-menu"> Uso</span></a></li>
            {% endif %}

          </ul>
        </nav>
      </div>
    </aside>

    <div class="page-wrapper">

        {% if request.user|has_rol:"EMPRESA" %}

        <div class="container-fluid">

          <div class="row page-titles">
            <div class="col-md-5 align-self-center">
                <h3 class="text-themecolor">Bienvenido</h3>
            </div>
            <div class="col-md-7 align-self-center">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="#">Home</a></li>
                </ol>
            </div>

        </div>

        <div class="row">
          <div class="col-4">
            <div class="card">
              <div class="card-body" style="height: 65vh;">
                <h4><b>Tu staff</b></h4>
                <div class="scrollbox mt-1" style="max-height: 50vh; overflow-y: auto;">
                  <div class="row box mr-2">
                    <div class="col-12">
                        <div class="bg-light p-3 m-1">
                            <div class="col-12">
                                <div class="row" style="display: contents;">
                                <div><h6 class='ml-2'><b>Abel Maximiliano Robra</b></h6></div>
                                </div>
                            </div>
                        </div>
                        <div class="bg-light p-3 m-1">
                          <div class="col-12">
                              <div class="row" style="display: contents;">
                              <div><h6 class='ml-2'><b>Abel Maximiliano Robra</b></h6></div>
                              </div>
                          </div>
                      </div>
                      <div class="bg-light p-3 m-1">
                        <div class="col-12">
                            <div class="row" style="display: contents;">
                            <div><h6 class='ml-2'><b>Abel Maximiliano Robra</b></h6></div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-light p-3 m-1">
                      <div class="col-12">
                          <div class="row" style="display: contents;">
                          <div><h6 class='ml-2'><b>Abel Maximiliano Robra</b></h6></div>
                          </div>
                      </div>
                  </div>
                  <div class="bg-light p-3 m-1">
                    <div class="col-12">
                        <div class="row" style="display: contents;">
                        <div><h6 class='ml-2'><b>Abel Maximiliano Robra</b></h6></div>
                        </div>
                    </div>
                </div>
                <div class="bg-light p-3 m-1">
                  <div class="col-12">
                      <div class="row" style="display: contents;">
                      <div><h6 class='ml-2'><b>Abel Maximiliano Robra</b></h6></div>
                      </div>
                  </div>
              </div>
              <div class="bg-light p-3 m-1">
                <div class="col-12">
                    <div class="row" style="display: contents;">
                    <div><h6 class='ml-2'><b>Abel Maximiliano Robra</b></h6></div>
                    </div>
                </div>
            </div>
                    </div>
                </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-8">
            <div class="card">
              <div class="card-body" style="height: 65vh;">
                <h4><b>Un resumen</b></h4>
                
              </div>
            </div>
          </div>
        </div>

        </div>

        {% elif request.user|has_rol:"USER" %}

        <input id="user_id" type="text" value="{{ request.user.id }}" style="display: none;"></input>

        <div class="container-fluid">
          {% block user %}
          <div class="row page-titles">
            <div class="col-md-5 align-self-center">
                <h3 class="text-themecolor">Bienvenido</h3>
            </div>
            <div class="col-md-7 align-self-center">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="#">Home</a></li>
                </ol>
            </div>

        </div>

        <div class="row">
          <div class="col-4">
            <div class="card">
              <div class="card-body" style="height: 65vh;">
                <div class="card-body">
                  <center class="m-t-30"> <img id="profile_image" {% if user.imagen %} src="{{user.imagen.url}}" {% else %} src="{% static 'img/anonimo2.png'%}" {% endif %} class="img-circle" width="150" />
                      <h4 class="card-title m-t-10">{{user.user.username}}</h4>
                      <h6 class="card-subtitle">{{user.user.email}}</h6>
                      <hr>
                      <div class="text-left">
                        <h4 class="card-title m-t-10">Nombre: {{user.user.first_name}}</h4>
                        <h4 class="card-title m-t-10">Apellido: {{user.user.last_name}}</h4>
                      </div>
                      
                  </center>
              </div>
              </div>
            </div>
          </div>
          <div class="col-8">
            <div class="card">
              <div class="card-body" style="height: 65vh;">

                <div class="row col-12 text-center justify-content-center p-3">

                  <h4>Tu ejecutivo de cuenta: <b class="text-primary">Mariano Goldman</b></h4>

                </div>

                <div class="row col-12 mt-2">
                    <div class="col-lg-6">
                      <div class="card bg-primary">
                          <div class="card-body">
                              <div class="d-flex no-block">
                                  <div class="m-r-20 align-self-center"><i class="fa fa-money fa-2x fa-lg text-light"></i></div>
                                  <div class="align-self-center">
                                      <h6 class="text-white m-t-10 m-b-0">Total prestado</h6>
                                      <h2 id="monto" class="m-t-0 text-white">$953,000</h2></div>
                              </div>
                          </div>
                      </div>

                      <div class="card bg-info">
                        <div class="card-body">
                            <div class="d-flex no-block">
                                <div class="m-r-20 align-self-center"><i class="fa fa-money fa-2x fa-lg text-light"></i></div>
                                <div class="align-self-center">
                                    <h6 class="text-white m-t-10 m-b-0">Cuotas pendientes</h6>
                                    <h2 id="cuotas"  class="m-t-0 text-white">12/30</h2></div>
                            </div>
                        </div>
                    </div>
                  </div>

                  <div class="col-lg-6">
                    <div class="card bg-success">
                        <div class="card-body">
                            <div class="d-flex no-block">
                                <div class="m-r-20 align-self-center"><i class="fa fa-money fa-2x fa-lg text-light"></i></div>
                                <div class="align-self-center">
                                    <h6 class="text-white m-t-10 m-b-0">Proximo vencimiento</h6>
                                    <h2 id="monto_proxima_cuota" class="m-t-0 text-white">$953,000</h2></div>
                            </div>
                        </div>
                    </div>

                    <div class="card bg-primary">
                      <div class="card-body">
                          <div class="d-flex no-block">
                              <div class="m-r-20 align-self-center"><i class="fa fa-money fa-2x fa-lg text-light"></i></div>
                              <div class="align-self-center">
                                  <h6 class="text-white m-t-10 m-b-0">Fecha vencimiento</h6>
                                  <h2 id="proximo_vencimiento" class="m-t-0 text-white">12/30</h2></div>
                          </div>
                      </div>
                  </div>
                </div>

                </div>
                
              </div>
            </div>
          </div>
        </div>
        {% endblock %}
        </div>
       
        {% else %}
        <div class="container-fluid">
        {% block content %}  

            <div class="row page-titles">
                <div class="col-md-5 align-self-center">
                    <h3 class="text-themecolor">Dashboard principal</h3>
                </div>
                <div class="col-md-7 align-self-center">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="javascript:void(0)">Home</a></li>
                        <li class="breadcrumb-item active">Dashboard</li>
                    </ol>
                </div>

            </div>

            <div class="row">
                <div class="col-lg-6">
                    <div class="card">
                        <div class="card-body">
                            <div class="d-flex no-block">
                                
                                <div class="align-self-center ">
                                    <h5><span class="lstick m-r-20"></span>Clientes con deuda menor a 90 dias </h5>
                                    <h6 class="text-muted m-t-10 m-b-0"><a href="#" data-toggle="modal" data-target="#DataPrestamos1">Situación 1: <b class="ml-2">{{cantidad_situaciones.user_1}}</b> - Monto afectado: ${{monto_situaciones.situacion_1|floatformat:2|intcomma}}</a></h6>
                                    <h6 class="m-t-0" style="font-size: 12px;">Deuda menor a 30 dias</h6>
                                    <h6 class="text-muted m-t-10 m-b-0"><a href="#" data-toggle="modal" data-target="#DataPrestamos2">Situación 2: <b class="ml-2">{{cantidad_situaciones.user_2}}</b> - Monto afectado: ${{monto_situaciones.situacion_2|floatformat:2|intcomma}}</a></h6>
                                    <h6 class="m-t-0" style="font-size: 12px;">Deuda menor a 60 dias</h6>
                                    <h6 class="text-muted m-t-10 m-b-0"><a href="#" data-toggle="modal" data-target="#DataPrestamos3">Situación 3: <b class="ml-2">{{cantidad_situaciones.user_3}}</b> - Monto afectado: ${{monto_situaciones.situacion_3|floatformat:2|intcomma}}</a></h6>
                                    <h6 class="m-t-0" style="font-size: 12px;">Deuda menor a 90 dias</h6></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6">
                    <div class="card">
                        <div class="card-body">
                            <div class="d-flex no-block">
                                
                                <div class="align-self-center">
                                    <h5><span class="lstick m-r-20"></span>Clientes con deuda mayor a 90 dias</h5>
                                    <h6 class="text-muted m-t-10 m-b-0"><a href="#" data-toggle="modal" data-target="#DataPrestamos4">Situación 4: <b class="ml-2">{{cantidad_situaciones.user_4}}</b> - Monto afectado: ${{monto_situaciones.situacion_4|floatformat:2|intcomma}}</a></h6>
                                    <h6 class="m-t-0" style="font-size: 12px;">Deuda menor a 180 dias</h6>
                                    <h6 class="text-muted m-t-10 m-b-0"><a href="#" data-toggle="modal" data-target="#DataPrestamos5">Situación 5: <b class="ml-2">{{cantidad_situaciones.user_5}}</b> - Monto afectado: ${{monto_situaciones.situacion_5|floatformat:2|intcomma}}</a></h6>
                                    <h6 class="m-t-0" style="font-size: 12px;">Deuda menor a 365 dias</h6>
                                    <h6 class="text-muted m-t-10 m-b-0"><a href="#" data-toggle="modal" data-target="#DataPrestamos6">Situación 6: <b class="ml-2">{{cantidad_situaciones.user_6}}</b> - Monto afectado: ${{monto_situaciones.situacion_6|floatformat:2|intcomma}}</a></h6>
                                    <h6 class="m-t-0" style="font-size: 12px;">Deuda en situación especial</h6></div>
                            </div>
                        </div>
                    </div>
                </div>

            <!-- Modales de los prestamos de los clientes -->
            
            <div class="modal fade" id="DataPrestamos1" tabindex="-1" role="dialog" aria-labelledby="DataPrestamos1"
              aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered" role="document">
                  <div class="modal-content">
                      <div class="modal-header"
                          style="background-color: #2a3e52;">
                          <h5 class="modal-title text-light" id="exampleModalLongTitle">Prestamos en situación 1</h5>
                          <button type="button" class="close text-light" data-dismiss="modal" aria-label="Close">
                              <span aria-hidden="true">&times;</span>
                          </button>
                      </div>
                      <div class="modal-body">
                        {% if cantidad_situaciones.user_datos_1 %}
                        <h6>Los prestamos afectados son: </h6>
                        <ul class="mt-2">
                          {% for data in cantidad_situaciones.user_datos_1 %}
                          <li>Prestamo de: {{data.cliente.nombre}}, {{data.cliente.apellido}} de ${{data.monto|floatformat:2|intcomma}} </li>
                          {% endfor %}
                        </ul>
                        {% else %}
                        <h6>No hay prestamos en esta situación</h6>
                        {% endif %}
                          

                      </div>
                  </div>
              </div>

              </div>

              <div class="modal fade" id="DataPrestamos2" tabindex="-1" role="dialog" aria-labelledby="DataPrestamos2"
              aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered" role="document">
                  <div class="modal-content">
                      <div class="modal-header"
                          style="background-color: #2a3e52;">
                          <h5 class="modal-title text-light" id="exampleModalLongTitle">Prestamos en situación 2</h5>
                          <button type="button" class="close text-light" data-dismiss="modal" aria-label="Close">
                              <span aria-hidden="true">&times;</span>
                          </button>
                      </div>
                      <div class="modal-body">
                        {% if cantidad_situaciones.user_datos_2 %}
                        <h6>Los prestamos afectados son: </h6>
                        <ul class="mt-2">
                          {% for data in cantidad_situaciones.user_datos_2 %}
                          <li>Prestamo de: {{data.cliente.nombre}}, {{data.cliente.apellido}} de ${{data.monto|floatformat:2|intcomma}} </li>
                          {% endfor %}
                        </ul>
                        {% else %}
                        <h6>No hay prestamos en esta situación</h6>
                        {% endif %}
                          

                      </div>
                  </div>
              </div>

              </div>

              <div class="modal fade" id="DataPrestamos3" tabindex="-1" role="dialog" aria-labelledby="DataPrestamos3"
              aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered" role="document">
                  <div class="modal-content">
                      <div class="modal-header"
                          style="background-color: #2a3e52;">
                          <h5 class="modal-title text-light" id="exampleModalLongTitle">Prestamos en situación 3</h5>
                          <button type="button" class="close text-light" data-dismiss="modal" aria-label="Close">
                              <span aria-hidden="true">&times;</span>
                          </button>
                      </div>
                      <div class="modal-body">
                        {% if cantidad_situaciones.user_datos_3 %}
                        <h6>Los prestamos afectados son: </h6>
                        <ul class="mt-2">
                          {% for data in cantidad_situaciones.user_datos_3 %}
                          <li>Prestamo de: {{data.cliente.nombre}}, {{data.cliente.apellido}} de ${{data.monto|floatformat:2|intcomma}} </li>
                          {% endfor %}
                        </ul>
                        {% else %}
                        <h6>No hay prestamos en esta situación</h6>
                        {% endif %}
                          

                      </div>
                  </div>
              </div>

              </div>

              <div class="modal fade" id="DataPrestamos4" tabindex="-1" role="dialog" aria-labelledby="DataPrestamos4"
              aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered" role="document">
                  <div class="modal-content">
                      <div class="modal-header"
                          style="background-color: #2a3e52;">
                          <h5 class="modal-title text-light" id="exampleModalLongTitle">Prestamos en situación 4</h5>
                          <button type="button" class="close text-light" data-dismiss="modal" aria-label="Close">
                              <span aria-hidden="true">&times;</span>
                          </button>
                      </div>
                      <div class="modal-body">
                        {% if cantidad_situaciones.user_datos_4 %}
                        <h6>Los prestamos afectados son: </h6>
                        <ul class="mt-2">
                          {% for data in cantidad_situaciones.user_datos_4 %}
                          <li>Prestamo de: {{data.cliente.nombre}}, {{data.cliente.apellido}} de ${{data.monto|floatformat:2|intcomma}} </li>
                          {% endfor %}
                        </ul>
                        {% else %}
                        <h6>No hay prestamos en esta situación</h6>
                        {% endif %}
                          

                      </div>
                  </div>
              </div>

              </div>

              <div class="modal fade" id="DataPrestamos5" tabindex="-1" role="dialog" aria-labelledby="DataPrestamos5"
              aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered" role="document">
                  <div class="modal-content">
                      <div class="modal-header"
                          style="background-color: #2a3e52;">
                          <h5 class="modal-title text-light" id="exampleModalLongTitle">Prestamos en situación 5</h5>
                          <button type="button" class="close text-light" data-dismiss="modal" aria-label="Close">
                              <span aria-hidden="true">&times;</span>
                          </button>
                      </div>
                      <div class="modal-body">
                        {% if cantidad_situaciones.user_datos_5 %}
                        <h6>Los prestamos afectados son: </h6>
                        <ul class="mt-2">
                          {% for data in cantidad_situaciones.user_datos_5 %}
                          <li>Prestamo de: {{data.cliente.nombre}}, {{data.cliente.apellido}} de ${{data.monto|floatformat:2|intcomma}} </li>
                          {% endfor %}
                        </ul>
                        {% else %}
                        <h6>No hay prestamos en esta situación</h6>
                        {% endif %}
                          

                      </div>
                  </div>
              </div>

              </div>

              <div class="modal fade" id="DataPrestamos6" tabindex="-1" role="dialog" aria-labelledby="DataPrestamos6"
              aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered" role="document">
                  <div class="modal-content">
                      <div class="modal-header"
                          style="background-color: #2a3e52;">
                          <h5 class="modal-title text-light" id="exampleModalLongTitle">Prestamos en situación 6</h5>
                          <button type="button" class="close text-light" data-dismiss="modal" aria-label="Close">
                              <span aria-hidden="true">&times;</span>
                          </button>
                      </div>
                      <div class="modal-body">
                        {% if cantidad_situaciones.user_datos_6 %}
                        <h6>Los prestamos afectados son: </h6>
                        <ul class="mt-2">
                          {% for data in cantidad_situaciones.user_datos_6 %}
                          <li>Prestamo de: {{data.cliente.nombre}}, {{data.cliente.apellido}} de ${{data.monto|floatformat:2|intcomma}} </li>
                          {% endfor %}
                        </ul>
                        {% else %}
                        <h6>No hay prestamos en esta situación</h6>
                        {% endif %}
                          

                      </div>
                  </div>
              </div>

              </div>

            </div>

            {% if sin_datos %}

            {% else %}
            <div class="row">
                <div class="col-lg-9 col-md-12">
                    <div class="card">
                        <div class="card-body">
                            <div class="d-flex">
                                <div>
                                    <h3 class="card-title m-b-5"><span class="lstick"></span>Historial de creditos otorgados</h3>
                                </div>
 
                            </div>
                        </div>

                        <div class="card-body">
                            <canvas id="myChart2"></canvas>
                            <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
                            <script>
        
                                var ctx = document.getElementById('myChart2').getContext('2d');
                                var myChart = new Chart(ctx, {
                                type: 'bar',
                                data: {
                                    labels: [{% for i in datos_grafico %}
                                            "{{i.0|date:'m/Y'}}",{% endfor %}],
                                    datasets: [{
                                        label: 'Monto nominal en el mes',
                                        data: [{% for i in datos_grafico %}
                                        "{{i.1|floatformat:0}}",{% endfor %}],
                                        backgroundColor: 'rgba(147, 78, 243, 0.2)',
                                        borderColor: 'rgba(147, 78, 243)',
                                        borderWidth: 1
                                    }]
                                },
                                options: {
                                    scales: {
                                        yAxes: [{
                                            ticks: {
                                                beginAtZero: true,
                                                callback: function(label, index, labels) {

                                                    return '$ ' + label;
                                                }
                                            }
                                        }]
                                    }
                                }
                            });
                          
                            </script>
                        </div>
                    </div>
                </div>
                <!-- ============================================================== -->
                <!-- visit charts-->
                <!-- ============================================================== -->
                <div class="col-lg-3 col-md-12">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="card-title"><span class="lstick"></span>Resumen de avance</h4>
                            <canvas id="myChart"></canvas>
                            <script>
        
                                var ctx = document.getElementById('myChart').getContext('2d');
                                var chart = new Chart(ctx, {
                                    // The type of chart we want to create
                                    type: 'doughnut',
                                    // The data for our dataset
                                    data: {
                                    datasets: [{        
                                        data: [{{total_pago}}, {{mora_total}}, {{total_saldo}}],
                                        backgroundColor: ['rgba(147, 78, 243, 0.6)', 'rgba(252, 48, 34, 0.6)', 'rgba(42, 40, 45, 0.6)'],    
                                    }],
                          
                                    labels: ["Pagado", "Moroso", "Saldo"]
                                  },
                                    options: {
                                      legend: false,
                                    },
                          
                                  });
                          
                            </script>
                  
                            <table class="table vm font-14">
                                <tr>
                                    <td>Cobrado</td>
                                    <td class="text-right font-medium">{{total_pago}}%</td>
                                </tr>
                                <tr>
                                    <td>Moroso</td>
                                    <td class="text-right font-medium">{{mora_total}}%</td>
                                </tr>
                                <tr>
                                    <td class="b-0">Saldo</td>
                                    <td class="text-right font-medium b-0">{{total_saldo}}%</td>
                                </tr>
                                

                            </table>

                            <h6>Total moroso:</h6>
                            <h6 class="text-danger">${{monto_mora|floatformat:0|intcomma}}</h6>
                            <hr>
                            <h6>Total saldo:</h6>
                            <h6 class="text-primary">${{monto_saldo|floatformat:0|intcomma}}</h6> 
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
              <div class="col-lg-9 col-md-12">
                  <div class="card">
                      <div class="card-body">
                          <div class="d-flex">
                              <div>
                                  <h3 class="card-title m-b-5"><span class="lstick"></span>Flujo de ingresos 24 meses</h3>
                              </div>

                          </div>
                      </div>

                      <div class="card-body">
                          <canvas id="myChart3"></canvas>
                          <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
                          <script>
      
                              var ctx = document.getElementById('myChart3').getContext('2d');
                              var myChart = new Chart(ctx, {
                              type: 'bar',
                              data: {
                                  labels: [{% for i in fechas_cash %}
                                          "{{i|date:'m/Y'}}",{% endfor %}],
                                  datasets: [{
                                      label: 'Cuotas a cobrar',
                                      data: [{% for i in matriz_resultante %}
                                      "{{i|floatformat:0}}",{% endfor %}],
                                      backgroundColor: 'rgba(42, 40, 45, 0.2)',
                                      borderColor: 'rgba(42, 40, 45)',
                                      borderWidth: 1
                                  }]
                              },
                              options: {
                                  scales: {
                                      yAxes: [{
                                          ticks: {
                                              beginAtZero: true,
                                              callback: function(label, index, labels) {

                                                  return '$ ' + label;
                                              }
                                          }
                                      }]
                                  }
                              }
                          });
                        
                          </script>
                      </div>
                  </div>
              </div>

          </div>
          {% endif %}
          {% endblock %}
        </div>
        {% endif %}

        <input id="token" type="text" value="{{ csrf_token }}" style="display: none;"></input>
        <input id="host" type="text" value="{% host %}" style="display: none;"></input>
        
        <footer class="footer"> © 2021 Soft Mapafer </footer>
    </div>

</div>

<style>

#add_user{
    position: fixed;
    bottom: 40px;
    right: 20px;
    z-index: 10;
}

.box:hover {
cursor: pointer;

}

.scrollbox {

overflow: hidden;
}

.scrollbox:hover {
overflow: auto;
}

.scrollbox::-webkit-scrollbar {
width: 6px;
}

.scrollbox::-webkit-scrollbar-thumb {
background-color: rgb(201, 201, 201);
border-radius: 100px;
}

      .go-corner {
	 display: flex;
	 align-items: center;
	 justify-content: center;
	 position: absolute;
	 width: 32px;
	 height: 32px;
	 overflow: hidden;
	 top: 0;
	 right: 0;
	 background-color: #2a3e52;;
	 border-radius: 0 4px 0 32px;
}
 .go-arrow {
	 margin-top: -4px;
	 margin-right: -4px;
	 color: white;
	 font-family: courier, sans;
}
.card1 p{
  display: none;
  font-size: 12px;
}
 .card1 {
	 display: block;
	 position: relative;
	 max-width: 262px;
	 border-radius: 4px;
	 text-decoration: none;
	 z-index: 0;
	 overflow: hidden;
}
 .card1:before {
	 content: "";
	 position: absolute;
	 z-index: -1;
	 top: -16px;
	 right: -16px;
	 background: #2a3e52;;
	 height: 32px;
	 width: 32px;
	 border-radius: 32px;
	 transform: scale(1);
	 transform-origin: 50% 50%;
	 transition: transform 0.25s ease-out;
}
 .card1:hover:before {
	 transform: scale(21);
}
 .card1:hover h6 {
   display: none;
}
 .card1:hover p {
   display: block;
	 transition: all 0.3s ease-out;
	 color: white;
}
 
 .card1:hover img {
  display: none;
  }
</style>



    <!-- PRUEBA IMPORTACIONES -->
<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="{% static 'js/f_alert.js' %}"></script>
<script src="{% static 'js/f_home.js' %}"></script>
{% if request.user|has_rol:"USER" %}
<script src="{% static 'js/f_home_user.js' %}"></script>
{% endif %}
<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js" defer></script>
<script src="https://cdn.datatables.net/1.10.23/js/dataTables.bootstrap4.min.js" defer></script>

    
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/2.5.0/jszip.min.js"defer></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"defer></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"defer></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"defer></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.7.0/js/dataTables.buttons.min.js"defer></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.7.0/js/buttons.html5.min.js"defer></script>

<!--Custom JavaScript -->

<script src="{% static 'adminpro/main/js/custom.min.js' %}"></script>
<script src="{% static 'adminpro/assets/plugins/jquery/jquery.min.js' %}"></script>

<!-- Bootstrap tether Core JavaScript -->
<script src="{% static 'adminpro/assets/plugins/bootstrap/js/popper.min.js' %}"></script>
<script src="{% static 'adminpro/assets/plugins/bootstrap/js/bootstrap.min.js' %}"></script>

<script src="{% static 'adminpro/main/js/sidebarmenu.js' %}"></script>
<!--stickey kit -->
<script src="{% static 'adminpro/assets/plugins/sticky-kit-master/dist/sticky-kit.min.js' %}"></script>
<script src="{% static 'adminpro/assets/plugins/sparkline/jquery.sparkline.min.js' %}"></script>
<!--Custom JavaScript -->
<script src="{% static 'adminpro/main/js/custom.min.js' %}"></script>
<!-- ============================================================== -->
<!-- Style switcher -->
<!-- ============================================================== -->
<script src="{% static 'adminpro/assets/plugins/styleswitcher/jQuery.style.switcher.js' %}"></script>

<!-- PRUEBA IMPORTACIONES -->

<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
    integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
    integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
    crossorigin="anonymous"></script>

<!-- scripts AdminPro -->

<script src="{% static 'adminpro/assets/plugins/jquery/jquery.min.js' %}"></script>
<script src="{% static 'adminpro/assets/plugins/bootstrap/js/popper.min.js' %}"></script>
<script src="{% static 'adminpro/assets/plugins/bootstrap/js/bootstrap.min.js' %}"></script>
<script src="{% static 'adminpro/main/js/perfect-scrollbar.jquery.min.js' %}"></script>
<script src="{% static 'adminpro/main/js/waves.js' %}"></script>
<script src="{% static 'adminpro/main/js/sidebarmenu.js' %}"></script>
<script src="{% static 'adminpro/main/js/custom.min.js' %}"></script>
<script src="{% static 'adminpro/assets/plugins/sparkline/jquery.sparkline.min.js' %}"></script>
<script src="{% static 'adminpro/assets/plugins/chartist-js/dist/chartist.min.js' %}"></script>
<script src="{% static 'adminpro/assets/plugins/chartist-plugin-tooltip-master/dist/chartist-plugin-tooltip.min.js' %}"></script>
<script src="{% static 'adminpro/assets/plugins/d3/d3.min.js' %}"></script>
<script src="{% static 'adminpro/assets/plugins/c3-master/c3.min.js' %}"></script>
<script src="{% static 'adminpro/main/js/dashboard1.js' %}"></script>
<script src="{% static 'adminpro/assets/plugins/styleswitcher/jQuery.style.switcher.js' %}"></script>
<script src="{% static 'adminpro/main/js/chat.js' %}"></script>
<script src="{% static 'adminpro/assets/plugins/switchery/dist/switchery.min.js' %}"></script>
<script src="{% static 'adminpro/assets/plugins/select2/dist/js/select2.full.min.js' %}"
    type="text/javascript"></script>
<script src="{% static 'adminpro/assets/plugins/bootstrap-select/bootstrap-select.min.js' %}"
    type="text/javascript"></script>
<script src="{% static 'adminpro/assets/plugins/bootstrap-select/bootstrap-select.min.js' %}"
    type="text/javascript"></script>
<script src="{% static 'adminpro/assets/plugins/bootstrap-tagsinput/dist/bootstrap-tagsinput.min.js' %}"></script>
<script src="{% static 'adminpro/assets/plugins/bootstrap-touchspin/dist/jquery.bootstrap-touchspin.min.js' %}"
    type="text/javascript"></script>
<script type="text/javascript"
    src="{% static 'adminpro/assets/plugins/multiselect/js/jquery.multi-select.js' %}"></script>

</body>


</html>




<script>

  function count() {
    var counter = { var: 0 };
    TweenMax.to(counter, 3, {
      var: 100,
      onUpdate: function () {
        var number = Math.ceil(counter.var);
        $('.counter').html(number);
        if (number === counter.var) { count.kill(); }
      },
      onComplete: function () {
        count();
      },
      ease: Circ.easeOut
    });
  }

  count();


</script>